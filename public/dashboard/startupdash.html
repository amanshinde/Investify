<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Startup Dashboard</title>
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #166088;
            --accent-color: #4fc3f7;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --border-radius: 12px;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        /* Button Styles */
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-decoration: none;
        }

        .btn i {
            font-size: 1.1rem;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
        }

        .btn-success {
            background-color: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background-color: #218838;
            transform: translateY(-2px);
        }

        .btn-warning {
            background-color: var(--warning-color);
            color: var(--dark-color);
        }

        .btn-warning:hover {
            background-color: #e0a800;
            transform: translateY(-2px);
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background-color: #c82333;
            transform: translateY(-2px);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: var(--dark-color);
            line-height: 1.6;
        }

        .container {
            display: flex;
            min-height: 100vh;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8eb 100%);
        }

        /* Enhanced Sidebar Styles */
        .sidebar {
            width: 280px;
            background: linear-gradient(to right,#004ea1 ,#1084ff );
            color: white;
            padding: 25px 0;
            transition: var(--transition);
            position: fixed;
            height: 100vh;
            box-shadow: var(--box-shadow);
            z-index: 1000;
        }

        .sidebar-header {
            padding: 0 25px 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-header h3 {
            color: white;
            font-weight: 600;
            font-size: 1.5rem;
            letter-spacing: 0.5px;
        }

        .sidebar-menu {
            padding: 25px 0;
        }

        .menu-item {
            padding: 15px 25px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            border-radius: 8px;
            margin: 8px 15px;
        }

        .menu-item:hover {
            background-color: rgba(255, 255, 255, 0.15);
            transform: translateX(5px);
        }

        .menu-item.active {
            background-color: rgba(255, 255, 255, 0.2);
            border-left: 4px solid var(--accent-color);
            font-weight: 500;
        }

        .menu-item i {
            margin-right: 15px;
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }

        /* Enhanced Main Content Styles */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 30px;
            transition: var(--transition);
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
            transition: var(--transition);
        }

        .header h2 {
            color: var(--secondary-color);
            font-size: 1.8rem;
            font-weight: 600;
        }

        .user-info {
            display: flex;
            align-items: center;
        }

        .user-info img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
        }

        /* Enhanced Card Styles */
        .card {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 30px;
            margin-bottom: 30px;
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .card-header h3 {
            color: var(--secondary-color);
            font-size: 1.4rem;
            font-weight: 600;
        }

        /* Enhanced Form Styles */
        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
            color: var(--dark-color);
            font-size: 1rem;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
            background-color: #f8f9fa;
        }

        .form-control:focus {
            border-color: var(--accent-color);
            outline: none;
            background-color: white;
            box-shadow: 0 0 0 3px rgba(79, 195, 247, 0.1);
        }

        textarea.form-control {
            min-height: 150px;
            resize: vertical;
        }

        /* Enhanced File Upload Styles */
        .file-upload {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px;
            border: 2px dashed #ddd;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            margin-bottom: 25px;
            background-color: #f8f9fa;
        }

        .file-upload:hover {
            border-color: var(--accent-color);
            background-color: rgba(79, 195, 247, 0.05);
            transform: translateY(-2px);
        }

        .file-upload i {
            font-size: 3rem;
            color: var(--accent-color);
            margin-bottom: 20px;
        }

        .file-upload p {
            margin-bottom: 20px;
            color: #666;
            font-size: 1.1rem;
        }

        .file-upload input[type="file"] {
            display: none;
        }

        /* Enhanced Pitch Card Styles */
        .pitch-card {
            border: 1px solid #eee;
            border-radius: var(--border-radius);
            padding: 25px;
            margin-bottom: 25px;
            transition: var(--transition);
            background-color: white;
        }

        .pitch-card:hover {
            box-shadow: var(--box-shadow);
            transform: translateY(-3px);
        }

        .pitch-card h4 {
            color: var(--secondary-color);
            margin-bottom: 15px;
            font-size: 1.3rem;
            font-weight: 600;
        }

        .pitch-card p {
            color: #666;
            margin-bottom: 20px;
            line-height: 1.7;
        }

        .pitch-card .pitch-meta {
            display: flex;
            justify-content: space-between;
            color: #888;
            font-size: 0.9rem;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .pitch-actions {
            display: flex;
            gap: 15px;
        }

        /* Enhanced Profile Modal Styles */
        .profile-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .profile-modal-content {
            position: relative;
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            width: 90%;
            max-width: 600px;
            border-radius: var(--border-radius);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .profile-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .profile-modal-header h3 {
            color: var(--secondary-color);
            margin: 0;
            font-size: 1.5rem;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            color: #666;
            transition: var(--transition);
        }

        .close-modal:hover {
            color: var(--danger-color);
            transform: rotate(90deg);
        }

        .profile-info {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 25px;
            margin-bottom: 25px;
        }

        .profile-logo {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #eee;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .profile-details h4 {
            margin: 0 0 15px 0;
            color: var(--secondary-color);
            font-size: 1.4rem;
        }

        .profile-details p {
            margin: 8px 0;
            color: #666;
            line-height: 1.6;
        }

        /* Enhanced Responsive Styles */
        @media (max-width: 992px) {
            .sidebar {
                width: 80px;
            }
            
            .sidebar-header h3, .menu-item span {
                display: none;
            }
            
            .menu-item {
                justify-content: center;
                padding: 15px;
            }
            
            .menu-item i {
                margin-right: 0;
                font-size: 1.4rem;
            }
            
            .main-content {
                margin-left: 80px;
            }
            
            .profile-info {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 20px;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .pitch-actions {
                flex-direction: column;
                gap: 10px;
            }
            
            .btn {
                width: 100%;
            }
            
            .metrics {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 576px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .container {
                flex-direction: column;
            }
            
            .menu-item {
                margin: 5px;
            }
            
            .profile-modal-content {
                width: 95%;
                margin: 10% auto;
            }
        }

        /* Animation for page transitions */
        [id$="-page"] {
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Enhanced hidden class */
        .hidden {
            display: none;
            opacity: 0;
            transform: translateY(20px);
        }

        /* Tab Styles */
        .tab-container {
            margin-bottom: 20px;
        }

        .tab-buttons {
            display: flex;
            border-bottom: 1px solid #ddd;
        }

        .tab-btn {
            padding: 10px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tab-btn.active {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color);
            font-weight: 500;
        }

        .tab-content {
            display: none;
            padding: 20px 0;
        }

        .tab-content.active {
            display: block;
        }
        @media (max-width: 768px) {
            .sidebar {
                width: 70px;
                overflow: hidden;
            }
            
            .sidebar-header h3, .menu-item span {
                display: none;
            }
            
            .menu-item {
                justify-content: center;
            }
            
            .menu-item i {
                margin-right: 0;
                font-size: 20px;
            }
            
            .main-content {
                margin-left: 70px;
            }
            
            .metrics {
                grid-template-columns: 1fr;
            }

            .investor-item {
                flex-direction: column;
                align-items: flex-start;
            }

            .investor-actions {
                margin-top: 10px;
                align-self: flex-end;
            }
        }
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--secondary-color);
        }

        .btn-success {
            background-color: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background-color: #218838;
        }

        .btn-warning {
            background-color: var(--warning-color);
            color: var(--dark-color);
        }

        .btn-warning:hover {
            background-color: #e0a800;
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background-color: #c82333;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h3>Startup Dashboard</h3>
            </div>
            <div class="sidebar-menu">
                <div class="menu-item active" data-page="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </div>
                <div class="menu-item" data-page="my-pitch">
                    <i class="fas fa-file-alt"></i>
                    <span>My Pitch</span>
                </div>
                <div class="menu-item" data-page="mentors">
                    <i class="fas fa-user-friends"></i>
                    <span>Mentors</span>
                  </div>
                <div class="menu-item" data-page="mentor-feedback">
                    <i class="fas fa-comments"></i>
                    <span>Mentor Feedback</span>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard Page -->
            <div id="dashboard-page">
                <div class="header">
                    <h2>Create Your Pitch</h2>
                    
                </div>

                <!-- Profile Modal -->
                

                <div class="card">
                    <div class="card-header">
                        <h3>Pitch Information</h3>
                    </div>
                    <form id="pitch-form">
                        <div class="form-group">
                            <label for="pitch-title">Pitch Title</label>
                            <input type="text" id="pitch-title" class="form-control" placeholder="Enter your pitch title" required>
                        </div>
                        <div class="form-group">
                            <label for="pitch-description">Pitch Description</label>
                            <textarea id="pitch-description" class="form-control" placeholder="Describe your startup, problem you're solving, solution, market opportunity, etc." required></textarea>
                        </div>
                        <div class="form-group">
                            <label>Upload Pitch Materials</label>
                            <div class="file-upload" id="video-upload">
                                <i class="fas fa-video"></i>
                                <p>Click to upload pitch video</p>
                                <span class="file-name" id="video-name">No file chosen</span>
                                <input type="file" id="pitch-video" accept="video/*">
                            </div>
                            <div class="file-upload" id="ppt-upload">
                                <i class="fas fa-file-powerpoint"></i>
                                <p>Click to upload pitch deck (PPT)</p>
                                <span class="file-name" id="ppt-name">No file chosen</span>
                                <input type="file" id="pitch-ppt" accept=".ppt,.pptx,.pdf">
                            </div>
                            <div class="file-upload" id="pdf-upload">
                                <i class="fas fa-file-pdf"></i>
                                <p>Click to upload additional PDF</p>
                                <span class="file-name" id="pdf-name">No file chosen</span>
                                <input type="file" id="pitch-pdf" accept=".pdf">
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Upload Pitch</button>
                    </form>
                </div>
            </div>

            <!-- My Pitch Page -->
            <div id="my-pitch-page" class="hidden">
                <div class="header">
                    <h2>My Pitch</h2>
                    <button class="btn btn-primary" id="profile-btn">
                        <i class="fas fa-user"></i> View Profile
                    </button>
                </div>

                <div id="profile-modal" class="profile-modal">
                    <div class="profile-modal-content">
                        <div class="profile-modal-header">
                            <h3>Startup Profile</h3>
                            <button class="close-modal">&times;</button>
                        </div>
                        <div class="profile-info">
                            <img id="profile-logo" class="profile-logo" src="https://via.placeholder.com/100" alt="Startup Logo">
                            <div class="profile-details">
                                <h4 id="profile-startup-name">Startup Name</h4>
                                <p><strong>Founder:</strong> <span id="profile-founder-name">Founder Name</span></p>
                                <p><strong>Industry:</strong> <span id="profile-industry">Industry</span></p>
                                <p><strong>Description:</strong> <span id="profile-description">Description</span></p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Current Pitch</h3>
                        <button class="btn btn-warning" id="edit-pitch-btn">Edit Pitch</button>
                    </div>
                    <div id="pitch-view">
                        <div class="pitch-card">
                            <h4 id="view-pitch-title"></h4>
                            <div class="pitch-meta">
                                <span>Last updated: <span id="view-pitch-date"></span></span>
                                <span>Status: <span class="text-success"></span></span>
                            </div>
                            <p id="view-pitch-description"></p>
                            <div class="pitch-actions">
                                <button class="btn btn-primary" id="view-video-btn">
                                    <i class="fas fa-play"></i> View Video
                                </button>
                                <button class="btn btn-primary" id="view-ppt-btn">
                                    <i class="fas fa-file-powerpoint"></i> View Deck
                                </button>
                                <button class="btn btn-primary" id="view-pdf-btn">
                                    <i class="fas fa-file-pdf"></i> View PDF
                                </button>
                            </div>
                        </div>
                    </div>

                    <div id="pitch-edit" class="hidden">
                        <form id="edit-pitch-form">
                            <div class="form-group">
                                <label for="edit-pitch-title">Pitch Title</label>
                                <input type="text" id="edit-pitch-title" class="form-control" value="Startup XYZ - Revolutionizing Industry ABC" required>
                            </div>
                            <div class="form-group">
                                <label for="edit-pitch-description">Pitch Description</label>
                                <textarea id="edit-pitch-description" class="form-control" required></textarea>
                            </div>
                            <div class="form-group">
                                <label>Update Pitch Materials</label>
                                <div class="file-upload" id="edit-video-upload">
                                    <i class="fas fa-video"></i>
                                    <p>Click to update pitch video</p>
                                    <span class="file-name" id="edit-video-name">Current: pitch_video.mp4</span>
                                    <input type="file" id="edit-pitch-video" accept="video/*">
                                </div>
                                <div class="file-upload" id="edit-ppt-upload">
                                    <i class="fas fa-file-powerpoint"></i>
                                    <p>Click to update pitch deck (PPT)</p>
                                    <span class="file-name" id="edit-ppt-name">Current: pitch_deck.pptx</span>
                                    <input type="file" id="edit-pitch-ppt" accept=".ppt,.pptx,.pdf">
                                </div>
                                <div class="file-upload" id="edit-pdf-upload">
                                    <i class="fas fa-file-pdf"></i>
                                    <p>Click to update additional PDF</p>
                                    <span class="file-name" id="edit-pdf-name">Current: additional_info.pdf</span>
                                    <input type="file" id="edit-pitch-pdf" accept=".pdf">
                                </div>
                            </div>
                            <div class="form-group">
                                <button type="submit" class="btn btn-success">Save Changes</button>
                                <button type="button" class="btn btn-danger" id="cancel-edit-btn">Cancel</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Engagement Page -->
            <!-- Mentors Page -->
    <div id="mentors-page" class="hidden">
        <div class="header">
          <h2>Mentors</h2>
        </div>
  
        <div class="card">
          <div class="card-header">
            <h3>Available Mentors</h3>
           
          </div>
          <div class="investor-list" id="mentor-list">
            <!-- Mentor profiles will be loaded here dynamically -->
          </div>
        </div>
      </div>
    </div>
  </div>
  </div>
  </div>
  
            <!-- Mentor Feedback Page -->
            <div id="mentor-feedback-page" class="hidden">
                <div class="header">
                    <h2>Mentor Feedback</h2>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Feedback Received</h3>
                        <div>
                            <select id="feedback-filter" class="form-control" style="width: auto; display: inline-block;">
                                <option value="all">All Feedback</option>
                                <option value="recent">Recent First</option>
                                <option value="rating-high">Highest Rating First</option>
                                <option value="rating-low">Lowest Rating First</option>
                            </select>
                        </div>
                    </div>

                    <div class="feedback-list">
                        <div class="feedback-item">
                            <div class="feedback-header">
                                <span class="feedback-mentor">Dr. Sarah Johnson (Investor, Tech Ventures)</span>
                                <span class="feedback-date">June 10, 2023</span>
                            </div>
                            <div class="feedback-rating">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star-half-alt"></i>
                                <span>(4.5/5)</span>
                            </div>
                            <div class="feedback-content">
                                <p>Your pitch is very compelling with a clear problem statement and solution. The market opportunity is well-defined. I suggest strengthening the competitive differentiation section - currently it's a bit light compared to the rest of the pitch. Also, consider adding more traction metrics if available. Overall great potential!</p>
                            </div>
                        </div>

                        <div class="feedback-item">
                            <div class="feedback-header">
                                <span class="feedback-mentor">Mark Williams (Entrepreneur in Residence, Startup Incubator)</span>
                                <span class="feedback-date">June 5, 2023</span>
                            </div>
                            <div class="feedback-rating">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="far fa-star"></i>
                                <span>(4/5)</span>
                            </div>
                            <div class="feedback-content">
                                <p>Strong pitch overall. The video could be more engaging in the first 30 seconds - you're losing some attention there. The financial projections seem optimistic - consider adding more conservative scenarios. Team slide is good but highlight more relevant experience. The product demo was excellent - that should come earlier in the presentation.</p>
                            </div>
                        </div>

                        <div class="feedback-item">
                            <div class="feedback-header">
                                <span class="feedback-mentor">Alex Chen (VC Partner, Growth Capital)</span>
                                <span class="feedback-date">May 28, 2023</span>
                            </div>
                            <div class="feedback-rating">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <span>(5/5)</span>
                            </div>
                            <div class="feedback-content">
                                <p>One of the best pitches I've seen this quarter. Clear value proposition, strong team, and impressive early traction. The ask is reasonable for the stage. I'd be interested in discussing investment opportunities. My only suggestion would be to tighten the timeline slide - some milestones seem too far out.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Profile Modal Functionality
            const profileBtn = document.getElementById('profile-btn');
            const profileModal = document.getElementById('profile-modal');
            const closeModal = document.querySelector('.close-modal');

            profileBtn.addEventListener('click', async function() {
                try {
                    const token = localStorage.getItem('token');
                    const response = await fetch('http://localhost:5000/api/profiles/dashboard-data', {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });

                    if (response.ok) {
                        const data = await response.json();
                        
                        // Update modal content with profile data
                        document.getElementById('profile-logo').src = data.logo || 'https://via.placeholder.com/100';
                        document.getElementById('profile-startup-name').textContent = data.startupName;
                        document.getElementById('profile-founder-name').textContent = data.founderName;
                        document.getElementById('profile-industry').textContent = data.industry;
                        document.getElementById('profile-description').textContent = data.description;
                        
                        profileModal.style.display = 'block';
                    } else {
                        alert('Failed to load profile data');
                    }
                } catch (error) {
                    console.error('Error loading profile:', error);
                    alert('Failed to load profile data');
                }
            });

            closeModal.addEventListener('click', function() {
                profileModal.style.display = 'none';
            });

            window.addEventListener('click', function(event) {
                if (event.target === profileModal) {
                    profileModal.style.display = 'none';
                }
            });

            // Page navigation
            const menuItems = document.querySelectorAll('.menu-item');
            const pages = document.querySelectorAll('[id$="-page"]');
            
            menuItems.forEach(item => {
                item.addEventListener('click', function() {
                    // Remove active class from all menu items
                    menuItems.forEach(i => i.classList.remove('active'));
                    // Add active class to clicked item
                    this.classList.add('active');
                    
                    // Hide all pages
                    pages.forEach(page => page.classList.add('hidden'));
                    
                    // Show selected page
                    const pageId = this.getAttribute('data-page') + '-page';
                    const selectedPage = document.getElementById(pageId);
                    selectedPage.classList.remove('hidden');

                    // If mentors page is selected, fetch mentors
                    if (pageId === 'mentors-page') {
                        fetchMentorProfiles();
                    }
                });
            });

            // Tab navigation for engagement page
            const tabButtons = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Remove active class from all buttons and contents
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    // Add active class to clicked button and corresponding content
                    this.classList.add('active');
                    const tabId = this.getAttribute('data-tab') + '-tab';
                    document.getElementById(tabId).classList.add('active');
                });
            });

            // Load pitch data when page loads
            async function loadPitchData() {
                try {
                    const token = localStorage.getItem('token');
                    if (!token) {
                        console.error('No authentication token found');
                        window.location.href = '/login.html';
                        return;
                    }

                    console.log('Loading pitch data...');
                    const response = await fetch('http://localhost:5000/api/pitches/my-pitches', {
                        headers: {
                            'Authorization': `Bearer ${token}`,
                            'Content-Type': 'application/json'
                        }
                    });

                    if (response.status === 401) {
                        localStorage.removeItem('token');
                        window.location.href = '/login.html';
                        return;
                    }

                    if (response.ok) {
                        const pitches = await response.json();
                        console.log('Received pitches:', pitches);
                        
                        if (pitches.length > 0) {
                            // Hide create pitch section and show my pitch section
                            document.getElementById('dashboard-page').classList.add('hidden');
                            document.getElementById('my-pitch-page').classList.remove('hidden');
                            
                            // Update active menu item
                            const dashboardMenuItem = document.querySelector('[data-page="dashboard"]');
                            const myPitchMenuItem = document.querySelector('[data-page="my-pitch"]');
                            
                            // Collapse dashboard menu item
                            dashboardMenuItem.style.display = 'none';
                            myPitchMenuItem.classList.add('active');
                            
                            const latestPitch = pitches[0];
                            console.log('Displaying latest pitch:', latestPitch);
                            
                            // Update pitch view with data
                            const pitchTitle = document.getElementById('view-pitch-title');
                            pitchTitle.textContent = latestPitch.title;
                            pitchTitle.setAttribute('data-video-url', latestPitch.videoUrl || '');
                            pitchTitle.setAttribute('data-ppt-url', latestPitch.pitchDeckUrl || '');
                            pitchTitle.setAttribute('data-pdf-url', latestPitch.pdfUrl || '');
                            
                            document.getElementById('view-pitch-description').textContent = latestPitch.description;
                            document.getElementById('view-pitch-date').textContent = new Date(latestPitch.updatedAt).toLocaleDateString('en-US', { 
                                year: 'numeric', 
                                month: 'long', 
                                day: 'numeric' 
                            });

                            // Update edit form with current values
                            document.getElementById('edit-pitch-title').value = latestPitch.title;
                            document.getElementById('edit-pitch-description').value = latestPitch.description;
                            
                            // Update file names in edit form
                            const videoName = document.getElementById('edit-video-name');
                            const pptName = document.getElementById('edit-ppt-name');
                            const pdfName = document.getElementById('edit-pdf-name');
                            
                            videoName.textContent = latestPitch.videoUrl ? 
                                'Current: ' + latestPitch.videoUrl.split('/').pop() : 'No file chosen';
                            pptName.textContent = latestPitch.pitchDeckUrl ? 
                                'Current: ' + latestPitch.pitchDeckUrl.split('/').pop() : 'No file chosen';
                            pdfName.textContent = latestPitch.pdfUrl ? 
                                'Current: ' + latestPitch.pdfUrl.split('/').pop() : 'No file chosen';

                            // Show the pitch view and hide the edit form
                            document.getElementById('pitch-view').classList.remove('hidden');
                            document.getElementById('pitch-edit').classList.add('hidden');
                        } else {
                            // Show create pitch section and hide my pitch section
                            document.getElementById('dashboard-page').classList.remove('hidden');
                            document.getElementById('my-pitch-page').classList.add('hidden');
                            
                            // Show dashboard menu item if it was hidden
                            const dashboardMenuItem = document.querySelector('[data-page="dashboard"]');
                            dashboardMenuItem.style.display = 'flex';
                            
                            // Update active menu item
                            const myPitchMenuItem = document.querySelector('[data-page="my-pitch"]');
                            myPitchMenuItem.classList.remove('active');
                            dashboardMenuItem.classList.add('active');
                        }
                    } else {
                        const errorText = await response.text();
                        console.error('Failed to load pitch data:', response.status, errorText);
                        alert('Failed to load pitch data. Please try again.');
                    }
                } catch (error) {
                    console.error('Error loading pitch data:', error);
                    alert('Failed to load pitch data. Please try again.');
                }
            }

            // Call loadPitchData when the page loads
            document.addEventListener('DOMContentLoaded', loadPitchData);
            
            // Add event listener for My Pitch menu item
            document.querySelector('[data-page="my-pitch"]').addEventListener('click', loadPitchData);

            // File upload functionality
            const videoUpload = document.getElementById('video-upload');
            const pptUpload = document.getElementById('ppt-upload');
            const pdfUpload = document.getElementById('pdf-upload');
            const videoInput = document.getElementById('pitch-video');
            const pptInput = document.getElementById('pitch-ppt');
            const pdfInput = document.getElementById('pitch-pdf');

            // Add click event listeners to file upload containers
            videoUpload.addEventListener('click', () => videoInput.click());
            pptUpload.addEventListener('click', () => pptInput.click());
            pdfUpload.addEventListener('click', () => pdfInput.click());

            // Add change event listeners to file inputs
            videoInput.addEventListener('change', function() {
                if (this.files.length > 0) {
                    document.getElementById('video-name').textContent = this.files[0].name;
                } else {
                    document.getElementById('video-name').textContent = 'No file chosen';
                }
            });

            pptInput.addEventListener('change', function() {
                if (this.files.length > 0) {
                    document.getElementById('ppt-name').textContent = this.files[0].name;
                } else {
                    document.getElementById('ppt-name').textContent = 'No file chosen';
                }
            });

            pdfInput.addEventListener('change', function() {
                if (this.files.length > 0) {
                    document.getElementById('pdf-name').textContent = this.files[0].name;
                } else {
                    document.getElementById('pdf-name').textContent = 'No file chosen';
                }
            });

            // Modify the pitch form submission to handle single pitch creation
            const pitchForm = document.getElementById('pitch-form');
            pitchForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                try {
                    const token = localStorage.getItem('token');
                    if (!token) {
                        alert('Please log in first');
                        window.location.href = '/login.html';
                        return;
                    }

                    const formData = new FormData();
                    formData.append('title', document.getElementById('pitch-title').value);
                    formData.append('description', document.getElementById('pitch-description').value);
                    formData.append('industry', 'Technology');
                    formData.append('marketDetails', 'Market details here');
                    formData.append('tractionDetails', 'Traction details here');

                    const videoFile = document.getElementById('pitch-video').files[0];
                    const pptFile = document.getElementById('pitch-ppt').files[0];
                    const pdfFile = document.getElementById('pitch-pdf').files[0];

                    if (videoFile) formData.append('video', videoFile);
                    if (pptFile) formData.append('pitchDeck', pptFile);
                    if (pdfFile) formData.append('pdf', pdfFile);

                    console.log('Sending pitch data to server...');
                    const response = await fetch('http://localhost:5000/api/pitches', {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${token}`
                        },
                        body: formData
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.msg || 'Failed to create pitch');
                    }

                    const data = await response.json();
                    console.log('Pitch created successfully:', data);
                    
                    // Reset form
                    pitchForm.reset();
                    document.getElementById('video-name').textContent = 'No file chosen';
                    document.getElementById('ppt-name').textContent = 'No file chosen';
                    document.getElementById('pdf-name').textContent = 'No file chosen';
                    
                    // Load the new pitch data and switch to My Pitch page
                    await loadPitchData();
                } catch (error) {
                    console.error('Error submitting pitch:', error);
                    if (error.message.includes('Failed to fetch')) {
                        alert('Cannot connect to the server. Please make sure the server is running on http://localhost:5000');
                    } else {
                        alert(error.message || 'Failed to create pitch. Please try again.');
                    }
                }
            });

            // My Pitch page functionality
            const editPitchBtn = document.getElementById('edit-pitch-btn');
            const pitchView = document.getElementById('pitch-view');
            const pitchEdit = document.getElementById('pitch-edit');
            const cancelEditBtn = document.getElementById('cancel-edit-btn');
            const editPitchForm = document.getElementById('edit-pitch-form');

            editPitchBtn.addEventListener('click', function() {
                pitchView.classList.add('hidden');
                pitchEdit.classList.remove('hidden');
            });

            cancelEditBtn.addEventListener('click', function() {
                pitchEdit.classList.add('hidden');
                pitchView.classList.remove('hidden');
            });

            editPitchForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Update the view with edited content
                document.getElementById('view-pitch-title').textContent = data.title;
                    document.getElementById('edit-pitch-title').value;
                document.getElementById('view-pitch-description').textContent = data.description;
                    document.getElementById('edit-pitch-description').value;
                document.getElementById('view-pitch-date').textContent = data.createdAt;
                    new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
                
                // Handle file updates in a real app
                const editVideoInput = document.getElementById('edit-pitch-video');
                if (editVideoInput.files.length > 0) {
                    document.getElementById('edit-video-name').textContent = 'Current: ' + editVideoInput.files[0].name;
                }
                
                const editPptInput = document.getElementById('edit-pitch-ppt');
                if (editPptInput.files.length > 0) {
                    document.getElementById('edit-ppt-name').textContent = 'Current: ' + editPptInput.files[0].name;
                }
                
                const editPdfInput = document.getElementById('edit-pitch-pdf');
                if (editPdfInput.files.length > 0) {
                    document.getElementById('edit-pdf-name').textContent = 'Current: ' + editPdfInput.files[0].name;
                }
                
                pitchEdit.classList.add('hidden');
                pitchView.classList.remove('hidden');
                
                alert('Pitch updated successfully!');
            });

            // View buttons functionality
            document.getElementById('view-video-btn').addEventListener('click', function() {
                const videoUrl = document.getElementById('view-pitch-title').getAttribute('data-video-url');
                if (videoUrl) {
                    window.open(`http://localhost:5000${videoUrl}`, '_blank');
                } else {
                    alert('No video available');
                }
            });

            document.getElementById('view-ppt-btn').addEventListener('click', function() {
                const pptUrl = document.getElementById('view-pitch-title').getAttribute('data-ppt-url');
                if (pptUrl) {
                    window.open(`http://localhost:5000${pptUrl}`, '_blank');
                } else {
                    alert('No pitch deck available');
                }
            });

            document.getElementById('view-pdf-btn').addEventListener('click', function() {
                const pdfUrl = document.getElementById('view-pitch-title').getAttribute('data-pdf-url');
                if (pdfUrl) {
                    window.open(`http://localhost:5000${pdfUrl}`, '_blank');
                } else {
                    alert('No PDF available');
                }
            });

            // Engagement page time period filter
            document.getElementById('time-period').addEventListener('change', function() {
                // In a real app, this would fetch new data based on the selected time period
                console.log('Time period changed to:', this.value);
            });

            // Feedback filter
            document.getElementById('feedback-filter').addEventListener('change', function() {
                // In a real app, this would filter or sort the feedback
                console.log('Feedback filter changed to:', this.value);
            });

            // Add this function to fetch mentor profiles
            async function fetchMentorProfiles() {
                try {
                    const token = localStorage.getItem('token');
                    if (!token) {
                        console.error('No token found');
                        window.location.href = '/login.html';
                        return;
                    }

                    console.log('Fetching mentor profiles...'); // Debug log
                    const response = await fetch('http://localhost:5000/api/profiles/mentors', {
                        headers: {
                            'Authorization': `Bearer ${token}`,
                            'Content-Type': 'application/json'
                        }
                    });

                    if (response.status === 401) {
                        localStorage.removeItem('token');
                        window.location.href = '/login.html';
                        return;
                    }

                    if (!response.ok) {
                        throw new Error(`Failed to fetch mentors: ${response.status} ${response.statusText}`);
                    }

                    const mentors = await response.json();
                    console.log('Fetched mentors:', mentors); // Debug log
                    renderMentorList(mentors);
                } catch (error) {
                    console.error('Error fetching mentors:', error);
                    alert('Failed to load mentors. Please try again later.');
                }
            }

            // Add this function to render mentor list
            function renderMentorList(mentors) {
                const mentorList = document.getElementById('mentor-list');
                if (!mentorList) {
                    console.error('Mentor list element not found');
                    return;
                }

                mentorList.innerHTML = '';

                if (!mentors || mentors.length === 0) {
                    mentorList.innerHTML = '<p class="empty-message">No mentors available at the moment.</p>';
                    return;
                }

                mentors.forEach(mentor => {
                    const mentorItem = document.createElement('div');
                    mentorItem.className = 'investor-item';
                    mentorItem.innerHTML = `
                        <div class="investor-info">
                            <div class="investor-avatar">
                                <img src="${mentor.profilePicture || 'https://via.placeholder.com/50'}" alt="${mentor.name}" style="width: 50px; height: 50px; border-radius: 50%; object-fit: cover;">
                            </div>
                            <div class="investor-details">
                                <div class="investor-name">${mentor.name}</div>
                                <div class="investor-position">${mentor.position}</div>
                                <div class="investor-expertise">
                                    ${mentor.expertise.map(exp => `<span class="expertise-tag">${exp}</span>`).join('')}
                                </div>
                            </div>
                        </div>
                        <div class="investor-actions">
                            <button class="btn btn-primary" onclick="window.requestMentorFeedback('${mentor._id}')">
                                <i class="fas fa-comments"></i> Request Feedback
                            </button>
                        </div>
                    `;
                    mentorList.appendChild(mentorItem);
                });
            }

            // Make requestMentorFeedback globally available
            window.requestMentorFeedback = async function(mentorId) {
                try {
                    const token = localStorage.getItem('token');
                    if (!token) {
                        window.location.href = '/login.html';
                        return;
                    }

                    const response = await fetch('http://localhost:5000/api/mentors/request-feedback', {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${token}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ mentorId })
                    });

                    if (response.ok) {
                        alert('Feedback request sent successfully!');
                    } else {
                        const error = await response.json();
                        alert(error.msg || 'Failed to send feedback request');
                    }
                } catch (error) {
                    console.error('Error requesting feedback:', error);
                    alert('Failed to send feedback request. Please try again later.');
                }
            };

            // Add event listener for mentors page
            const mentorsMenuItem = document.querySelector('[data-page="mentors"]');
            if (mentorsMenuItem) {
                mentorsMenuItem.addEventListener('click', fetchMentorProfiles);
            } else {
                console.error('Mentors menu item not found');
            }
        });
    </script>
</body>
</html>